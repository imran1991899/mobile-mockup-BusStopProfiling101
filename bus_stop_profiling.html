<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bus Stop Profiling Survey</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #e8edf9;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
  }

  .page-wrapper {
    width: 420px;
    height: 100vh;
    background: white;
    border-radius: 30px;
    margin-top: 10px;
    overflow-y: auto;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }

  .header {
    background: #0b2a78;
    padding: 22px;
    color: white;
    font-size: 23px;
    font-weight: bold;
    border-radius: 30px 30px 0 0;
  }

  .content { padding: 25px; }

  label {
    display: block;
    margin-top: 18px;
    font-weight: bold;
    font-size: 15px;
    color: #111;
  }

  input[type="text"], select {
    width: 100%;
    padding: 12px;
    margin-top: 8px;
    border-radius: 10px;
    border: 1px solid #c9c9c9;
    font-size: 15px;
  }

  /* DOTTED UPLOAD BOX */
  .photo-slot {
    width: 100%;
    border: 2px dashed #2ecc71;
    border-radius: 14px;
    padding: 12px;
    margin-top: 15px;
    background: #f8fff8;
    transition: 0.2s;
  }

  .photo-slot:hover { background: #edffed; }

  .upload-title {
    text-align: center;
    color: #1a8c3a;
    font-size: 16px;
    margin-bottom: 10px;
  }

  .controls {
    display: flex;
    justify-content: center;
    gap: 10px;
  }

  .controls button {
    padding: 8px 12px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    color: white;
    font-size: 14px;
  }

  .btn-camera { background: #e67e22; }
  .btn-upload { background: #2980b9; }
  .hidden { display: none; }

  button.submit-btn {
    margin-top: 25px;
    width: 100%;
    padding: 15px;
    background-color: #0b2a78;
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 18px;
    cursor: pointer;
  }

</style>
</head>

<body>

<div class="page-wrapper">

  <div class="header">Bus Stop Profiling</div>

  <div class="content">

    <form id="profilingForm">
      
      <label>üë§ Staff ID (8 digits)</label>
      <input type="text" id="staffId" maxlength="8" value="10011070" required>
      <small style="display: block; margin-top: 5px; color: #555;">FARNO HAZLINA BINTI MUHAMMAD APANDI</small>

      <label>1Ô∏è‚É£ Select Depot</label>
      <select id="depot" required>
        <option value="">--Select Depot--</option>
        <option value="Batu Caves">Batu Caves</option>
        <option value="Cheras Selatan">Cheras Selatan</option>
        <option value="Maluri">Maluri</option>
      </select>

      <label>2Ô∏è‚É£ Select Route Number</label>
      <select id="route" required>
        <option value="">--Select Route--</option>
      </select>

      <label>3Ô∏è‚É£ Select Bus Stop</label>
      <select id="busStop" required>
        <option value="">--Select Bus Stop--</option>
      </select>

      <!-- 4Ô∏è‚É£ Direction (Auto-filled after bus stop selection) -->
      <label>4Ô∏è‚É£ Direction</label>
      <select id="direction" required>
        <option value="">--Select Direction--</option>
      </select>

      <label>5Ô∏è‚É£ Bus Stop Condition</label>
      <select id="condition" required>
        <option value="">--Select Condition--</option>
        <option>Covered Bus Stop</option>
        <option>Pole Only</option>
        <option>Layby</option>
        <option>Non-Infrastructure</option>
      </select>

      <!-- 6Ô∏è‚É£ Issue -->
      <label>6Ô∏è‚É£ Issue</label>
      <select id="issue" required>
        <option value="">--Select Issue--</option>
        <option>Construction in progress nearby the bus stop</option>
        <option>Missing infrastructure</option>
        <option>Covered by trees</option>
        <option>Malfunction lights</option>
        <option>Outdated info panel</option>
        <option>No bus marking - shelter</option>
        <option>No bus marking - pole</option>
        <option>No street lighting</option>
        <option>Parking issue</option>
      </select>

      <!-- 7Ô∏è‚É£ Subcategory -->
      <label>7Ô∏è‚É£ Subcategory</label>
      <select id="subcat1" required>
        <option value="">--Select Subcategory--</option>
        <option>A2 - Pax</option>
        <option>B1 - Missing Pole</option>
        <option>C1 - Routine</option>
        <option>C2 - Infra</option>
        <option>C3 - Bus Bay (Shelter)</option>
        <option>C4 - Bus Bay (Pole)</option>
        <option>C5 - Street Lighting</option>
        <option>D1 - Enforcement</option>
      </select>

      <!-- 8Ô∏è‚É£ Category -->
      <label>8Ô∏è‚É£ Category</label>
      <select id="subcat2" required>
        <option value="">--Select Category--</option>
        <option>A - Safety</option>
        <option>B - Insufficient Infra</option>
        <option>C - Maintenance</option>
        <option>D - Enforcement</option>
      </select>

      <label>üì∏ Upload Pictures (Camera / File)</label>
      <div id="photoContainer"></div>

      <button type="submit" class="submit-btn">Send</button>
    </form>

  </div>
</div>

<script>
// Map of Route and Bus Stops to Directions
const routeBusStops = {
  "151": {
    "SL283 DATARAN BANDAR BARU SELAYANG": "A-B",
    "SL287 STADIUM MPS (BARAT)": "A-B",
    "SL288 BULATAN BERINGIN SELAYANG": "A-B",
    // Add other stops for Route 151 here
  },
  "170": {
    "SL294 HAB WIRA DAMAI": "A-B",
    "SL182 PANGSAPURI KENANGA": "A-B",
    "SL183 PANGSAPURI CEMPAKA": "A-B",
    // Add other stops for Route 170 here
  },
  "171": {
    "SL294 HAB WIRA DAMAI": "A-B",
    "SL182 PANGSAPURI KENANGA": "A-B",
    "SL183 PANGSAPURI CEMPAKA": "A-B",
    // Add other stops for Route 171 here
  }
};

// Event listener for Depot selection to update Route dropdown
document.getElementById("depot").addEventListener("change", function() {
  const depot = this.value;
  const routeSelect = document.getElementById("route");

  // Clear the current options
  routeSelect.innerHTML = '<option value="">--Select Route--</option>';

  // Populate routes based on selected depot
  if (depot === "Batu Caves") {
    // Add relevant routes for Batu Caves
    const routes = ["151", "170", "171"];
    routes.forEach(route => {
      const option = document.createElement("option");
      option.value = route;
      option.textContent = route;
      routeSelect.appendChild(option);
    });
  } else if (depot === "Cheras Selatan") {
    // Add relevant routes for Cheras Selatan
    const routes = ["540"];
    routes.forEach(route => {
      const option = document.createElement("option");
      option.value = route;
      option.textContent = route;
      routeSelect.appendChild(option);
    });
  } else if (depot === "Maluri") {
    // Add relevant routes for Maluri
    const routes = ["221"];
    routes.forEach(route => {
      const option = document.createElement("option");
      option.value = route;
      option.textContent = route;
      routeSelect.appendChild(option);
    });
  }
});

// Event listener for Route selection to populate Bus Stops
document.getElementById("route").addEventListener("change", function() {
  const route = this.value;
  const busStopSelect = document.getElementById("busStop");

  // Clear the current options
  busStopSelect.innerHTML = '<option value="">--Select Bus Stop--</option>';

  // Populate bus stops based on selected route
  if (routeBusStops[route]) {
    for (let stop in routeBusStops[route]) {
      const option = document.createElement("option");
      option.value = stop;
      option.textContent = stop;
      busStopSelect.appendChild(option);
    }
  }
});

// Event listener for Bus Stop selection to auto-fill Direction
document.getElementById("busStop").addEventListener("change", function() {
  const route = document.getElementById("route").value;
  const busStop = this.value;
  const directionSelect = document.getElementById("direction");

  // Clear current direction
  directionSelect.innerHTML = '<option value="">--Select Direction--</option>';

  if (routeBusStops[route] && routeBusStops[route][busStop]) {
    const direction = routeBusStops[route][busStop];
    const option = document.createElement("option");
    option.value = direction;
    option.textContent = direction;
    directionSelect.appendChild(option);
  }
});

/* ----------------------------------
   FORM SUBMIT + PARTIAL RESET
---------------------------------- */
document.getElementById("profilingForm").addEventListener("submit", function(e){
  e.preventDefault();

  const staffId = document.getElementById("staffId").value.trim();
  const depot = document.getElementById("depot").value.trim();
  const route = document.getElementById("route").value.trim();
  const busStop = document.getElementById("busStop").value.trim();
  const condition = document.getElementById("condition").value;
  const issue = document.getElementById("issue").value.trim();
  const direction = document.getElementById("direction").value;
  const subcat1 = document.getElementById("subcat1").value.trim();
  const subcat2 = document.getElementById("subcat2").value.trim();

  if(!/^\d{8}$/.test(staffId)){
    alert("‚ö†Ô∏è Staff ID must be exactly 8 digits.");
    return;
  }
  if(!depot || !route || !busStop || !condition || !issue || !subcat1 || !subcat2 || !direction){
    alert("‚ö†Ô∏è Please fill all fields.");
    return;
  }

  alert("‚úÖ Submitted successfully!");

  // Reset but keep some values
  document.getElementById("busStop").value = "";
  document.getElementById("route").value = "";
  document.getElementById("depot").value = "";
  document.getElementById("condition").value = "";
  document.getElementById("issue").value = "";
  document.getElementById("direction").value = "";
  document.getElementById("subcat1").value = "";
  document.getElementById("subcat2").value = "";

});
</script>

</body>
</html>
